# Look-Into-Wazuh

https://documentation.wazuh.com/current/deployment-options/docker/wazuh-container.html

## Why?

1. Wazuh platform provides XDR and SIEM features to protect our cloud, container, and server workloads.
   - XDR (Extended Detection and Response) helps in detecting, investigating, and responding to threats across various environments.
   - SIEM (Security Information and Event Management) centralizes security data from multiple sources, enabling real-time analysis and response to security incidents.
2. We'll have:
   a. **Log analysis**: Analyzing logs from various sources to identify security threats and anomalies.
   b. **Intrusion and malware detection**: Detecting unauthorized access and malicious software within the environment.
   c. **File integrity monitoring**: Monitoring changes to files and directories to detect unauthorized modifications.
   d. **Configuration assessment**: Evaluating system configurations against security best practices to identify vulnerabilities.
   e. **Vulnerability detection**: Identifying known vulnerabilities in software and systems to mitigate risks.
   f. **Support for regulatory compliance**: Assisting in meeting compliance requirements by providing security monitoring and reporting capabilities.
3. Aside from agent-based monitoring capabilities, Wazuh can monitor agent-less devices such as firewalls, switches, routers, or network IDS, etc.

## Components:

### Wazuh Indexer:

- Highly scalable, full-text search and analytics engine.
- Central component that indexes and stores alerts generated by Wazuh server.

### Wazuh Server:

- Analyzes data received from agents.
- It processes it through decoders and rules, using threat intelligence to look for well-known indicators of compromise (IoCs).
- This central component is responsible for managing agents, configuring and upgrading them remotely when necessary

### Wazuh Dashboard:

- Web user interface for data visualization and analysis.
- Out of the box dashboards for:

  - Threat hunting
  - Regulatory compliance (e.g.
    - PCI DSS(Payment Card Industry Data Security Standard):
      - A set of security standards designed to ensure that all companies that accept, process, store or transmit credit card information maintain a secure environment.
    - GDPR(General Data Protection Regulation):
      - A regulation in EU law on data protection and privacy in the European Union and the European Economic Area.
      - This regulation requires organizations to protect personal data and ensure the privacy of individuals.
    - CIS (Center for Internet Security)
      - A nonprofit organization that develops best practices and benchmarks for securing IT systems and data.
    - HIPAA (Health Insurance Portability and Accountability Act)
      - A US law that provides data privacy and security provisions for safeguarding medical information.
    - NIST 800-53 (US National Institute of Standards and Technology)
      - A set of security and privacy controls for federal information systems and organizations.
  - Detected vulnerable applications
  - File integrity monitoring data
  - Configuration assessment results
  - Cloud infrastructure monitoring events

- `systemctl status wazuh-dashboard`
- Default credentials:
  - Username: admin
  - Password: changeme
    > Change the credentials using the password changing tool

### Wazuh Agent:

- Installed on endpoints such as laptops, desktops, servers, and containers.
- They provide threat prevention, detection, and response capabilities.

#### Problems When Deploying:

- If getting `mv: cannot overwrite '/var/ossec/etc/shared/default': Directory not empty`
  - backup the older file and let the post install script finish `sudo dpkg --configure -a`
  - or just remove the file `sudo rm -rf /var/ossec/etc/shared/default` (not recommended for production)

![Wazuh Components](./images/Wazuh-Components.png)
